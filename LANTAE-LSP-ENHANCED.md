# 🤖 Lantae AI-Enhanced Language Server Protocol

> **Inspiration Credit**: Special thanks to the Engineer and Founder of [CubicLayer.com](https://cubiclayer.com) for inspiring this enhanced LSP implementation with their vision of seamless AI-powered development tools.

## Overview

Your Lantae LSP server now automatically detects, tracks, and provides enhanced language support for **any code generated by Lantae AI**. The system works across multiple programming languages and provides special features for AI-generated code.

## ✨ Key Features

### 🏷️ Automatic Code Tagging
- **All code created by Lantae is automatically tagged** with metadata headers
- Supports **15+ programming languages** with appropriate comment styles
- Tracks generation context, timestamps, and tools used
- Creates `.lantae-generated.json` metadata file for project-wide tracking

### 🌐 Multi-Language Support
The LSP server provides intelligent features for:
- **JavaScript/TypeScript** (`.js`, `.ts`)
- **Python** (`.py`)
- **Go** (`.go`)
- **Rust** (`.rs`)
- **Java** (`.java`)
- **C/C++** (`.c`, `.cpp`, `.h`)
- **HTML/CSS** (`.html`, `.css`)
- **SQL** (`.sql`)
- **Shell Scripts** (`.sh`, `.bash`)
- **YAML** (`.yaml`, `.yml`)
- **Ruby** (`.rb`)
- **PHP** (`.php`)

### 🧠 AI-Enhanced Features for Generated Code

When you open a file generated by Lantae, you get:

#### Special Completions
- 🤖 **Lantae: Refactor this code** - AI-powered refactoring suggestions
- 🤖 **Lantae: Optimize performance** - Performance improvement suggestions
- 🤖 **Lantae: Generate tests** - Automatic test generation
- 🤖 **Lantae: Add documentation** - Documentation generation
- 📅 **Generation timestamp** - When the code was created

#### Enhanced Hover Information
- Shows **"Generated by Lantae AI"** badge
- Displays creation timestamp and tool used
- Provides language-specific built-in documentation
- Lists available AI actions for the code

#### Visual Indicators
- Lantae-generated symbols are marked with **(Lantae AI)** in completions
- Special hover tooltips show generation context
- File metadata is preserved and displayed

## 🚀 Usage Examples

### Creating Code with Lantae

```bash
# Any code creation automatically gets tagged
./index.js "create a python function to calculate fibonacci"
./index.js "write a go web server with health check endpoint"
./index.js "generate a SQL schema for user management"
```

Each generated file will have:
- **Language-appropriate header** with metadata
- **Tracking in .lantae-generated.json**
- **Enhanced LSP features** when opened in supported editors

### Sample Tagged Python File
```python
# Generated by Lantae AI v1.0.0 - 2025-07-26T03:49:00.159Z
# Context: {"tool":"create_file","timestamp":"2025-07-26T03:49:00.159Z"}

def fibonacci(n):
    if n <= 1:
        return n
    return fibonacci(n-1) + fibonacci(n-2)
```

### Sample Tagged JavaScript File
```javascript
/* Generated by Lantae AI v1.0.0 - 2025-07-26T03:49:00.159Z */
/* Context: {"tool":"create_file","timestamp":"2025-07-26T03:49:00.159Z"} */

class WebServer {
    constructor(port = 3000) {
        this.port = port;
    }
}
```

## 🔧 Integration with Editors

### VS Code
The included VS Code extension (`vscode-extension/`) provides:
- **Multi-language support** for all 15+ languages
- **Context menus** with Lantae AI actions
- **Keyboard shortcuts**: `Ctrl+Shift+A` (analyze), `Ctrl+Shift+O` (optimize)
- **Automatic LSP server** connection

### Other Editors
Works with any LSP-compatible editor:

#### Vim/Neovim (coc.nvim)
```json
{
  "languageserver": {
    "lantae": {
      "command": "node",
      "args": ["/path/to/ollama-code/lsp-server.js", "--stdio"],
      "filetypes": ["javascript", "python", "go", "rust", "java", "cpp", "c", "html", "css", "sql", "sh", "yaml", "ruby", "php"],
      "rootPatterns": ["package.json", ".lantae-generated.json"]
    }
  }
}
```

#### Emacs (lsp-mode)
```elisp
(lsp-register-client
 (make-lsp-client 
   :new-connection (lsp-stdio-connection '("node" "/path/to/ollama-code/lsp-server.js" "--stdio"))
   :activation-fn (lsp-activate-on "javascript" "python" "go" "rust" "java" "cpp" "c" "html" "css" "sql" "sh" "yaml" "ruby" "php")
   :server-id 'lantae))
```

## 📋 Available Commands

### LSP Commands
- `lantae.analyzeFile` - Analyze current file for issues and improvements
- `lantae.optimizeCode` - Get AI-powered performance suggestions
- `lantae.generateTests` - Generate comprehensive test cases
- `lantae.refactorCode` - Get intelligent refactoring suggestions

### CLI Commands
```bash
# Start LSP server
npm run lsp-server

# Test LSP functionality
npm run lsp-test

# Generate code (automatically tagged)
./index.js "your code request here"
```

## 🗂️ Metadata Tracking

### .lantae-generated.json Structure
```json
{
  "files": ["hello.py", "server.go", "styles.css"],
  "snippets": {
    "hello.py": {
      "tool": "create_file",
      "language": "python", 
      "size": 154,
      "timestamp": "2025-07-26T03:49:00.160Z",
      "version": "1.0.0"
    }
  },
  "lastUpdate": "2025-07-26T03:49:00.160Z",
  "version": "1.0.0"
}
```

### Header Examples by Language

#### Python
```python
# Generated by Lantae AI v1.0.0 - 2025-07-26T03:49:00.159Z
# Context: {"tool":"create_file","timestamp":"2025-07-26T03:49:00.159Z"}
```

#### Go
```go
// Generated by Lantae AI v1.0.0 - 2025-07-26T03:49:00.159Z
// Context: {"tool":"create_file","timestamp":"2025-07-26T03:49:00.159Z"}
```

#### HTML
```html
<!-- Generated by Lantae AI v1.0.0 - 2025-07-26T03:49:00.159Z -->
<!-- Context: {"tool":"create_file","timestamp":"2025-07-26T03:49:00.159Z"} -->
```

#### SQL
```sql
-- Generated by Lantae AI v1.0.0 - 2025-07-26T03:49:00.159Z
-- Context: {"tool":"create_file","timestamp":"2025-07-26T03:49:00.159Z"}
```

## 🔍 Detection Patterns

The system detects Lantae-generated code through:
1. **Metadata file lookup** (`.lantae-generated.json`)
2. **Header pattern matching**:
   - `Generated by Lantae AI`
   - `_lantae_metadata`
   - `Context:.*lantae`
   - `🤖.*Generated with.*Lantae`

## 🎯 Benefits

### For Developers
- **Instant recognition** of AI-generated code
- **Enhanced tooling** for AI-created files
- **Project-wide tracking** of AI contributions
- **Language-agnostic** AI assistance

### For Teams
- **Clear attribution** of AI-generated code
- **Consistent metadata** across all languages
- **Integration with existing workflows**
- **Audit trail** for AI usage

### For AI Development
- **Context preservation** for iterative improvements
- **Tool usage tracking** for analytics
- **Version management** for AI-generated assets
- **Cross-language consistency**

## 🔧 Configuration

### LSP Settings
```json
{
  "lantae": {
    "maxNumberOfProblems": 1000,
    "aiProvider": "ollama",
    "aiModel": "cogito:latest", 
    "enableIntelliSense": true,
    "enableCodeAnalysis": true
  }
}
```

### File Watching
The LSP server automatically watches:
- `.lantae-generated.json` for metadata changes
- All tracked files for content updates
- Project structure for new Lantae files

## 🚦 Getting Started

1. **Use Lantae to create code** - Any file creation is automatically tagged
2. **Open tagged files** in your LSP-compatible editor
3. **See enhanced features** - Hover, completion, and commands
4. **Use AI actions** - Refactor, optimize, test, document

The system works transparently - just use Lantae as normal and get enhanced editor support automatically!

## 🔗 Technical Architecture

```
Lantae CLI
    ↓ (creates code)
LantaeCodeTracker
    ↓ (tags files)  
.lantae-generated.json
    ↓ (metadata)
LSP Server
    ↓ (enhanced features)
Editor (VS Code, Vim, etc.)
```

The integration is seamless and requires no additional configuration - it just works! 🎉